Vue.filter("toURL",function(e){var t,i={a:/[\xE0-\xE6]/g,e:/[\xE8-\xEB]/g,i:/[\xEC-\xEF]/g,o:/[\xF2-\xF6]/g,u:/[\xF9-\xFC]/g,c:/\xE7/g,n:/\xF1/g};for(t in i)e=e.replace(i[t],t);return e.replace(/ /g,"-").toLowerCase()}),Vue.directive("draw-tiles",function(){});var MapEditor=function(){function e(e,t,i,s){var a,l,d,r;a=this,l="Default",r=i*s;var h={el:"#map-editor",data:{panels:{selected:"tiles",tiles:{selectedLayer:"",selectedTile:0},collisions:{},entities:{}},tiles:{width:e,height:t,limitX:i,limitY:s,src:"",data:[]},stage:{grid:{visible:!0,tiles:[]},collisions:{visible:!0,tiles:[]},layers:[],mousedown:!1,mode:"draw"}},methods:{selectPanel:function(e){this.panels.selected=e.target.dataset.panel},selectTile:function(e){this.panels.tiles.selectedTile=Number(e.target.dataset.index)},mouseOverTile:function(e){e.preventDefault(),e.target.classList.add("hover"),this.stage.mousedown?this.mouseDownTile(e):e.target.classList.add("tile-hover-"+this.panels.tiles.selectedTile)},mouseOutTile:function(e){e.preventDefault(),e.target.classList.remove("tile-hover-"+this.panels.tiles.selectedTile),e.target.classList.remove("hover")},mouseDownTile:function(e){e.preventDefault(),this.stage.mousedown=!0,this.stage.layers[$(e.target).parent().index()-2].tiles[$(e.target).index()].value=2===e.which?!1:this.panels.tiles.selectedTile},mouseUpTile:function(e){e.preventDefault(),this.stage.mousedown=!1},mouseMoveTile:function(e){e.preventDefault()}}};for(d=0;r>d;d++)h.data.stage.grid.tiles.push({x:d%h.data.tiles.limitX*h.data.tiles.width,y:~~(d/h.data.tiles.limitX)*h.data.tiles.height,width:h.data.tiles.width,height:h.data.tiles.height}),h.data.stage.collisions.tiles.push({x:d%h.data.tiles.limitX*h.data.tiles.width,y:~~(d/h.data.tiles.limitX)*h.data.tiles.height,width:h.data.tiles.width,height:h.data.tiles.height,value:!1});this.$listLayers=$("#list-layers").sortable({axis:"y",distance:5,start:function(e,t){t.item.data("start",t.item.index())},update:function(e,t){var i=t.item.data("start"),s=t.item.index();a.vm.stage.layers.splice(s,0,a.vm.stage.layers.splice(i,1)[0])}}),this.vm=new Vue(h),this.addLayer(l),this.addLayer("Test 1"),this.addLayer("Test 2"),this.addLayer("Test 3")}return e.prototype.addLayer=function(e){var t,i=this.vm.tiles.limitX*this.vm.tiles.limitY,s={title:e,visible:!0,tiles:[]};for(t=0;i>t;t++)s.tiles.push({x:t%this.vm.tiles.limitX*this.vm.tiles.width,y:~~(t/this.vm.tiles.limitX)*this.vm.tiles.height,value:!1});this.vm.stage.layers.push(s),this.vm.panels.tiles.selectedLayer||(this.vm.panels.tiles.selectedLayer=e),this.$listLayers.sortable("refresh")},e.prototype.addTile=function(e){var t=this,i=new Image;i.onload=function(){t.vm.tiles.src=e;var i,s=~~(this.width/t.vm.tiles.width),a=~~(this.height/t.vm.tiles.height),l=s*a;for(i=0;l>i;i++)t.vm.tiles.data.push({x:i%s*t.vm.tiles.width,y:~~(i/s)*t.vm.tiles.height})},i.src=e},e.prototype.export=function(){},e}();