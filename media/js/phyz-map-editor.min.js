Vue.filter("toURL",function(t){var e,i={a:/[\xE0-\xE6]/g,e:/[\xE8-\xEB]/g,i:/[\xEC-\xEF]/g,o:/[\xF2-\xF6]/g,u:/[\xF9-\xFC]/g,c:/\xE7/g,n:/\xF1/g};for(e in i)t=t.replace(i[e],e);return t.replace(/ /g,"-").toLowerCase()}),Vue.directive("draw-tiles",function(){});var MapEditor=function(){function t(t,e,i,s){var a,l,h,d;a=this,l="Default",d=i*s;var r={el:"#map-editor",data:{panels:{selected:"tiles",tiles:{selectedLayer:"",selectedTile:0},collisions:{},entities:{}},tiles:{width:t,height:e,limitX:i,limitY:s,src:"",data:[]},stage:{grid:{visible:!0,tiles:[]},collisions:{visible:!0,tiles:[]},layers:[],mousedown:!1,mode:"draw"}},methods:{selectPanel:function(t){this.panels.selected=t.target.dataset.panel},selectTile:function(t){this.panels.tiles.selectedTile=Number(t.target.dataset.index)}}};for(h=0;d>h;h++)r.data.stage.grid.tiles.push({x:h%r.data.tiles.limitX*r.data.tiles.width,y:~~(h/r.data.tiles.limitX)*r.data.tiles.height,width:r.data.tiles.width,height:r.data.tiles.height}),r.data.stage.collisions.tiles.push({x:h%r.data.tiles.limitX*r.data.tiles.width,y:~~(h/r.data.tiles.limitX)*r.data.tiles.height,width:r.data.tiles.width,height:r.data.tiles.height,value:!1});this.$listLayers=$("#list-layers").sortable({axis:"y",distance:5,start:function(t,e){e.item.data("start",e.item.index())},update:function(t,e){var i=e.item.data("start"),s=e.item.index();a.vm.stage.layers.splice(s,0,a.vm.stage.layers.splice(i,1)[0])}}),this.vm=new Vue(r),this.addLayer(l),this.addLayer("Test 1"),this.addLayer("Test 2"),this.addLayer("Test 3")}return t.prototype.addLayer=function(t){var e,i=this.vm.tiles.limitX*this.vm.tiles.limitY,s={title:t,visible:!0,tiles:[]};for(e=0;i>e;e++)s.tiles.push({x:e%this.vm.tiles.limitX*this.vm.tiles.width,y:~~(e/this.vm.tiles.limitX)*this.vm.tiles.height,width:this.vm.tiles.width,height:this.vm.tiles.height,value:!1});this.vm.stage.layers.push(s),this.vm.panels.tiles.selectedLayer||(this.vm.panels.tiles.selectedLayer=t),this.$listLayers.sortable("refresh")},t.prototype.addTile=function(t){var e=this,i=new Image;i.onload=function(){e.vm.tiles.src=t;var i,s=~~(this.width/e.vm.tiles.width),a=~~(this.height/e.vm.tiles.height),l=s*a;for(i=0;l>i;i++)e.vm.tiles.data.push({x:i%s*e.vm.tiles.width,y:~~(i/s)*e.vm.tiles.height})},i.src=t},t.prototype.export=function(){},t}();